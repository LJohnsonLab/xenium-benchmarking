# Benchmarking Cell Segmentation Methods for Xenium In Situ Data

## Research Goal

This project systematically evaluates computational methods for cell segmentation in data generated by the 10x Genomics Xenium platform. Xenium provides high-resolution, subcellular mapping of hundreds to thousands of RNA targets, but accurate assignment of these transcripts to individual cells poses a critical challenge that significantly impacts downstream biological interpretation.

**Our original Xenium data provides nuclear positions via DAPI staining but not full cell boundaries**. Computational segmentation methods must therefore infer cell boundaries based on nuclear positions and transcript distributions. We investigate how different segmentation strategies—from simple nuclei-centric expansions to transcript-aware probabilistic models—perform across various tissue architectures.

## Evaluation Framework

We assess segmentation quality using three complementary metrics:

1. **Specificity (Negative Marker Purity):** Quantifies the percentage of reads assigned to a cell that do not belong to known negative markers for that cell type, based on a matched single-cell reference. High purity indicates successful exclusion of neighboring contamination.

2. **Separation Accuracy (Doublet Rate):** Uses Robust Cell Type Decomposition (RCTD) in doublet mode to classify cells as mixtures of two cell types. High doublet rates reveal segmentation errors or excessive tissue expansion.

3. **Sensitivity (Transcripts/Genes per Cell):** Tracks data utilization efficiency by measuring total high-quality transcripts and unique genes successfully assigned to each segmented mask.

## Analysis Results

### [1. Reference scRNA-seq Data](_output/1.reference_scRNAseq.md)
### [2. Assignment Efficiency (Sensitivity)](_output/2.assignment.md)

We compared segmentation performance across five nuclear expansion distances: 0, 3, 5, 10, and 20 micrometers. Key findings:

- **Transcript recovery scales with expansion:** The fraction of transcripts assigned increased from 0.344 at 0 μm to 0.985 at 20 μm expansion, representing a 2.9-fold improvement.
- **Cell content increases progressively:** Median transcripts per cell rose from 365 to 1,068 across the expansion range.
- **Gene-specific spatial patterns emerge:** Genes with transcripts located farther from nuclei (GFAP, ALDOC, MT2) showed systematically higher unassignment rates. We observed a strong correlation (R = 0.93) between median nucleus distance and transcript unassignment.


### [3. Label Transfer and Doublet Detection (RCTD) for the 5 μm expansion](_output/3.RCTD.md)

We transferred cell type annotations from the scRNA-seq reference to Xenium data using Seurat's anchor-based integration with CCA dimensionality reduction. We then applied RCTD to assess segmentation quality. Critical results:

- **Label transfer succeeded despite limited features:** 

- **High doublet rate indicates segmentation challenges:** RCTD classified only 21.9% of segmented objects as singlets. 62.3% were certain doublets and 14.2% were uncertain doublets, yielding a combined doublet rate exceeding 76%.

- **Cell type-specific patterns reveal biological and technical factors:** 


